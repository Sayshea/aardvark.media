module App

open Aardvark.UI
open Aardvark.UI.Primitives

open Aardvark.Base
open Aardvark.Base.Incremental
open Aardvark.Base.Rendering

open System

open Model

let size = 4

let generateBoard () : hmap<pos,card> = 
    let rand = new System.Random()

    let swap (a: _[]) x y =
        let tmp = a.[x]
        a.[x] <- a.[y]
        a.[y] <- tmp

    // shuffle an array (in-place)
    let shuffle a =
        Array.iteri (fun i _ -> swap a i (rand.Next(i, Array.length a))) a

    let halfInitArray = seq { 1 .. (size * size / 2)} |> Seq.toList
    let rec doubleArray x = 
        match x with
        | [] -> []
        | x :: xs -> x :: x :: (doubleArray xs)

    let initArray = (doubleArray halfInitArray)|> List.toArray
    
    shuffle initArray
    
    let l = [
        for y in [0 .. size - 1] do
            for x in [0 .. size - 1] do
                let position : pos = (x,y)
                yield position, {value = initArray.[(y) * size + (x)]; flipped = false}
    ] 
    HMap.ofList l

let initialValues =
    let n = size * size / 2
    {
        numberFlipped = 0
        board = generateBoard ()
        firstFlipped = (-1, -1)
        secondFlipped = (-1, -1)
        moves = 0
        timer = DateTime.Now
        infoText = "Pairs left: " + (string n)
    }

let flipCard (p:pos) (board:hmap<pos,card>) =
    match p with
    | (-1,-1) -> board
    | _ ->
        let b = board.[p]
        match b.flipped with
        | true -> 
            HMap.add p { value = b.value; flipped = false} board
        | false ->
            HMap.add p { value = b.value; flipped = true} board

let flip3Cards p1 p2 pnew b =
    let b1 = flipCard p1 b
    let b2 = flipCard p2 b1
    flipCard pnew b2

let checkPairs b =
    b
    |> HMap.filter (fun x y -> y.flipped = false)
    |> HMap.count

let update (m:Model) (msg : Message) =
    match msg with 
        | Flip p -> 
            let position = p
            match m.numberFlipped with
            | 1 ->
                match m.board.[m.firstFlipped].value = m.board.[p].value with
                | true ->
                    let n = (checkPairs m.board) / 2
                    let txt = 
                        let t = ( DateTime.Now - m.timer ).TotalSeconds
                        match n with
                        | 0 -> "You won! It took you " + sprintf "%.3f" t + " Seconds"
                        | _ -> "Pairs left: " + (string n)
                    { m with
                        firstFlipped = (-1,-1)
                        secondFlipped = (-1,-1)
                        numberFlipped = 2
                        moves = m.moves + 1
                        board = flipCard p m.board
                        infoText = txt
                    }
                | false -> 
                    { m with 
                        secondFlipped = p
                        numberFlipped = 2
                        moves = m.moves + 1
                        board = flipCard p m.board
                    }
            | 2 ->
                let fF = m.firstFlipped
                { m with 
                    firstFlipped = p
                    numberFlipped = 1
                    board = flip3Cards fF m.secondFlipped p m.board
                }
            | _ -> 
                let n = (checkPairs m.board) / 2
                { m with 
                    firstFlipped = p
                    numberFlipped = 1
                    board = flipCard p m.board
                    timer = DateTime.Now
                    infoText = "Pairs left: " + (string n)
                }
        | Reset -> 
            let n = size * size / 2
            { m with
                firstFlipped = initialValues.firstFlipped
                secondFlipped = initialValues.secondFlipped
                moves = initialValues.moves
                numberFlipped = initialValues.numberFlipped
                board = generateBoard ()
                infoText = "Restarting ... Pairs left: " + (string n)
            }

let view (m : MModel) =
    let aget (b : amap<pos,card>) (x,y) = AMap.find (x,y) b

//        img [
//            // standard image stuff
//            attribute "src" "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Ardvark_The_Aardvark_Original.png/800px-Ardvark_The_Aardvark_Original.png"; 
//            attribute "alt" "aardvark"
//            // if we start drag, use drag(event) defined in js to activate dragging
//            attribute "ondragstart" "drag(event)"
//            style "width: 200px"
//            // just a class to identify this element in human readable way
//        ]

    let selectedCard i =
        match i with
        | 1 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTUpfQbz3QAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABB0lEQVR42u3dsQ2DMBBA0bsoEzEfKzCUhzEFFSWd00eJaDnr/ZYG82QbgQQ5xhihx/RyCYAICBABASIgQAQEiIAICBABASIgQAQEiIAICBABASIgQAQEiIAICBABASIgQAQEiIAICBABASIg/1vXNTIzMrPcueds3zo5jiOWZYnee0REVBveuzrAdV1xnmf03qO1Ftu2xb7vZcdTfobcLUvVhmdTB6Kp95BfS1LFuyszBIiAABEQIAICREAEBIiAVKv8w8W7B4nfx5/+fsQMAaKpl6zZ/kdjhgARECACAkRAgAgIEAERECACAkRAgAgIEAERECACAkRAgAgIEAERECACAkRA5u0DHHkyP9F6sq0AAAAASUVORK5CYII="
        | 2 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTca8ODwSQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACY0lEQVR42u3dsUrrUBzH8d8pl1bopClUIZBJqOBS8gZCOxbRRXAXHLo49wHc+gTiC2ieoF0c3MziVOiipRQklOJQpVD+boELF+69g7f3hO93ypDhnH5Icw4tiTMzE/03lfgIACFAACFAACFAACFAACFACBBACBBACBBACBBACBACBBACBBACBBACBBAChAABhAABhAABhAABhAAhQAAhQPzth68DX61WGgwGGg6HStNUo9FI8/lczjnVajU1m02dnp7q7OxMlUrFm3k5Xx+tEQSB5vP5b887ODhQkiRqNBqAfOvAnfvjc/f29vT8/KwgCLiHfFdhGOri4kK3t7d6enpSlmVarVZ6e3vTw8ODjo+P83Nns5mur6/9mJgVuG63a5JMku3v73sxZlfkxzO9vr4qiiJJUqVS0efnJ19Zm2x3dzc/LpfL7EM23cvLy0+rLUA23N3dXX7c6XRY9m6y6XSqw8NDLRYLbW9vazwea2dnhytkEy2XS52cnGixWMg5p5ubGy8wCrnsXS6X1mq18uVur9fzavyFAnl/f7ejo6Mc4/Ly0rs5FAZkNptZHMc5xtXVlZfzKARImqYWhqFJslKpZP1+39u5eA+SJIlVq1WTZFtbW3Z/f+/1fLwFWa/X1uv1zDlnkqxer9vj46P3V7uXIFmWWbvdzu8XcRzbZDIpxL3QS5AoinKM8/Nz+/j4KMxK0cud+t/8OPWLfRc7dQLE27z810mRX3nCFQIIAQIIAQIIAQIIAQIIAUKAAEKAAEKAAEKAAEKAECCAECCAECCAECCAECAECCAECCAECCD0j/oCXvUSAiW/iGgAAAAASUVORK5CYII"
        | 3 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTcwK1s5nwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAC1klEQVR42u3csUsycRzH8Y+PFWdGQ3RCYRDkEA1ZDQ1uQUs11BTR6FIRDf4BUXNDREsQOLa0t7ikIC6h0FREUENRYiSadUXaPdMjNDzQA0+dJ+/3dMINd7743d33ED22bduihukXXwEgBAggBAggBAggBAggBAgBAggBAggBAggBAggBQoAAQoAAQoAAQoAAQoAQIIAQIIAQIIAQIIAQIAQIIASIe2tx64FXq1Wl02klk0lls1mdnZ2pUCjo+flZPp9PPT09CofDmpub0/z8vFpbW11xXh63/rWGaZp6eHj40r4DAwM6PDzU2NgYIN924B7PP+3f2dmpbDarUCjEPeS7Vsjs7Ky2traUTCZ1fX2tSqWi9/d35fN5pVIpraysyOv1SpLK5bI2NjZYIU63v7+vpaUlSVIgEFA+nwfEyV5eXuT3+yVJhmHIsiwuWU52e3tb3w6Hw8whTmZZlmKxWP3z+vo6c8hPVqvV9PT0pMvLSx0fH2tvb09XV1cyDEM7OzuamZnhpu7kY7Df79f09LQ2Nzc1NDTEpO50y8vLWlhYcA1G06+QP0UiEcXjcQ0ODgLyk318fKhUKqlYLOr09FTxeFxHR0f1QTKXyykYDDb2SdhN3trami3JlmRHo9GGP96mHwxvbm7U19cnSert7f00l3DJcqDX11f5fD5JUltbm97e3hgMnSyXy9W3u7u7mdSd7PHxUaurq/XPExMTPGV9R4FAQJOTkxofH9fw8LD6+/tlmqba29tlWZYuLi6USCS0u7uru7s7SZLX69XJyYlGR0cB+cmZ429tb29/eq/FJes/Zprml/ft6urSwcGBKzBcu0JqtZoymUz9Bw7n5+e6v79XpVKRYRgyTVMjIyOamprS4uKiOjo6eHVCPGUBQoAAQoAAQoAQIIAQIIAQIIAQIIAQIAQIIAQIIAQIIAQIIAQIAQIIAQIIAQIIAQIIAUKANHS/AbKSdhq6cSz1AAAAAElFTkSuQmCC"
        | 4 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTgEjXfR5QAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABwklEQVR42u3cMYrCQBiG4W/WrUSFHEEsPEGuYCVYW3gLwcYi4GUsUsTKO2iTRiy08AhK2pB/u0AQFpYFN7/7vl1M4+QhM+MUBjMzUWv64BEAQoAAQoAAQoAAQoAAQoAQIIAQIIAQIIAQIIAQIAQIIAQIIAQIIAQIIAQIAQIIAQIIAQIIAQIIAUKAAEKAANKq9vu9Op2OQggKIbj67uHd/lrjcrkojmM9Ho/6M09DfKs3pCgKzWazBgZT1h9lZlosFjqfz6whbShJEu12Oxb1NpRlmTabTX29XC5dv+quO51O1u/3TZJJsslkYmVZ1tfehuh6l3W/3xXHsa7XqyRpNBrpeDwqiqLGdpdd1guqqkrz+bzG6PV6yrJMURS53524bLVa1VNSCMHSNG3c9zpluQTZbreNB75er58HBshryvPcut1u/bCn06lVVfU2IO4W9eFwqNvtJkkaj8c6HA4aDAbPZ0JOF3V3IL89LGz7cDl+B4S+69PjIeJPpzZ+GBIggBAggBC7rFfvxnhDCBBACBBACBBACBBACBACBBACBBACBBACBBAChAABhAABhAABhAABhAAhQAAhQAAhQAAhQP5pXwIIR8S00g6uAAAAAElFTkSuQmCC"
        | 5 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTgTDqRUIgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACEklEQVR42u3dzcoxYRzH8Z+nyXtsJsXKzoYsLG0kpdTkFByHlY1TcARyBl6KUPZKWc9CspKE0pS67p2156k7xvP9rkaNmny6rum/uQSMMUb0Mf3hJwCEAAGEAAGEAAGEAAGEACFAACFAACFAACFAACFACBBACBBACBBACBBACBACBBACBBACBBACBBAChAABhADxb5afHz4QCPz1dz794ApWCCD0tVuWn7YiVgggBAggBMiL2batUCgky7KUTCaVz+fVarU0m838NVv5+Yi/VwdDx3E0GAwUj8cB+ZRJvVKpaD6f/9N0z5b1YoVCQZ1OR6vVSqfTSY/HQ5fLRdvtVr1eT7lc7nnvcrlUv9/3xUD1td3vd1OtVo0kI8nU6/WPf+bAtx8Tu16vVSqVJEnpdFqHw4F3yDvzPE/hcFiSFAwG5Xke75B3dr1en9eJRII55N1NJpPndT6fB+Sd7fd7tdvt5+dms8kc8ltlMhk1Gg2Vy2UVCgVls1klEgkZY7Tb7TQcDtXtdnU8HiVJqVRKrusqFosB8u6h0LIsjcdj1Wo1tqzfKhqNvrySptOpLzB8vUJut5tGo5EWi4U2m41c19X5fJYxRrZtq1gsynEctVotRSIR/6x8/j+ELYsAAYQAAYQAAYQAAYQAIUAAIUAAIUAAIUAAIUAIEEAIEEAIEEAIEEAIEAIEEAIEEAIEEALkv+wHg6QS/EFv2iIAAAAASUVORK5CYII="
        | 6 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTgjKH1kjgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAADC0lEQVR42u3cP0sjQQCH4V8u64IYUQJamMJGBZEYRK1EwUIQo9hY+6e008ZGG4tUgr1fQNMYQRAVlJQWCmJhoVYqoiAaNYImuMx1c82Zu4Nb7za8LwQmMCkmTzKTLCEhY4wR/Td94ykAhAABhAABhAABhAABhAAhQAAhQAAhQAAhQAAhQAgQQAgQQAgQQAgQQAgQAgQQAgQQAgQQAgQQAoQAAYQAAeSf9/b2po2NDY2Pj6u9vV319fVyHEe1tbVKJpOBWUeoHP5aY319XbOzs7q+vv50TlCWGfh3yNzcnMbGxkpisGV9UalUSktLS/Z+PB7XysqKzs7O9Pr6qnw+r62tLfX19QVnUSagnZ6eGtd1jSQjySwsLBjP80zQCyzI8PCwxZiZmTHlUiAP9ZubGzU2NsrzPMViMV1cXKiyspIz5F+VyWTkeZ4kaXJysmwwAgtyeHhoxwMDA8pms5qYmFBTU5Oqqqrkuq5isZhGRkaUyWSCtbgg7rOJRMKeHx0dHXb82W1wcNC8vLxwhvhVQ0ODbm9v/+gx/f392t/fVygUYsv62z0/P9txIpHQ8vKyjo+Plc/nVSwWdXd3p52dHfX29tp52WxWq6urbFl+5DiO3Y4KhcKn8z4+PkwymbRzh4aG/vu1BfIdUlNT8+NiXIktKBwOa3Fx0d4/OTnhU5YfRaNRO87lciXntrW12fH9/T0gfhSPx3/7VV8oFOw4EokA4kc9PT12vLa2VnLuwcGBHbe0tHCo+9HV1ZWpqKgwkkw4HDbb29s/nff+/m66u7vtoZ5Kpbi46FdTU1P2iXZd18zPz5vz83NTLBbN4+Oj2dzcNJ2dnXZONBo1uVwOEL96enoyzc3Nv/yWLsk4jmN2d3e5/O53l5eXpqurqyRGXV2d2dvb4/L7V+V5ntLptNLptI6OjvTw8KBIJKLW1laNjo5qenpa1dXVgVlPWfzIoZzid1mAECCAECCAECCAECCAECAECCAECCAECCAECCAECAECCAECCAECCAECCAFCgABCgABCgABCX9R3/zFYVQDNrnUAAAAASUVORK5CYII="
        | 7 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTgx28QVxgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACGElEQVR42u3coQoiQRzH8d+eV7QINhEsG7aKGmwWg81g0SpGswbduC/gG1h8BfEJBIsWkyDoA7hbRLY4l27x2nHhdIbvFwwGwfHDn90ZZD1jjBF9TT/4CQAhQAAhQAAhQAAhQAAhQAgQQAgQQAgQQAgQQAgQAgQQAgQQAgQQAgQQAoQAAYQAAYQAAYQAAYQAIUAAIUDs7aeNX9rzvH/+7Lc/uIIJAYScAzHG/PXr+XyqWq0C8i0tl0vdbjdJUqfT+f7ro8uPZ7rf7/J9X0mSyPM87fd7NZtNJuRTRVGkJEkkSf1+/+sxnJ6Q6/WqIAiUpqlyuZxOp5OCIOAa8qnm87nSNJUkjUYjKzCcnZDD4aBGoyFjjPL5vM7nsyqVCndZn2o6nWY78slkYg2GkxOy3W7V7XYlScViUZfLRaVSiX3IJ3q9XprNZn9Mik0Yv3e9zrRarYwkI8mUy2XzeDysW4MzE5KmqcIwzN6HYahCoWDdOpwBeT8i8X1f4/HYynU4cVGP41i+7yuOY0nSer3WcDi0ci1OTEgURRlGrVbTYDCwdi3WT8j7EYkkbTab7LaXCflAi8Uiw2i321ZjWD8hx+NR9Xo925Xvdju1Wi2rQayekPcjkl6vZz2Gk0cntsefHAAhQAAhQAAhQAAhQAAhQAgQQAgQQAgQQAgQQAgQAgQQAgQQAgQQAgQQAoQAAYQAAYQAAYT+U78A2CdHJnhuR1cAAAAASUVORK5CYII="
        | 8 -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCTkB5AYUKwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAADTklEQVR42u3cPUtrWRSA4RXxIzEahChRUVQMfiGIKBaSKoWdhYWN2As2ChaKFiIGbSzsFNRaC/0Nen6AWIhIFNEiEJJIRIyJJhzWVLNB/Li3mHNnzvC+ENjCas55yE52EvSoqgr9ZyrjFgBCgABCgABCgABCgABCgBAggBAggBAggBAggBAgBAggBAggBAggBAggBAgBAggBAggBAggBAggBQoAAQoAA8q/19vYmOzs7Eo1Gpb6+XioqKiQYDEokEpHNzU3JZrPuuiB1cdfX19rT06Mi8u0jFAqpZVmuuSaPW//XSSaTkYGBAUkmk7+crampkYuLCwmHw2xZThWLxQyG1+uVWCwmd3d3ks/nJR6Py+LiopSXl4uISC6Xk7W1NbYsJ2trazPb0sHBwZczW1tbZqaxsZEty8mqqqqkWCyKiMjT05PU1dV9mkmn0xIKhcyzqFAosGU5VVNTk1mnUqkvZ6qrq826vb2dt71ONj4+btazs7Py+vr6aeby8tKsJyYmeA1xslQqpeFw2LxGtLa26u7urr68vJiZqakpFRFtaGjQZDLpiuty9TkkkUhoNBr9cO7w+/06OTmp8/PzKiIaDAb17OzMNdfkahBV1aOjI/X5fFpWVvblwXB1dVVt2wbE6Z6fn82zo7+/X8/PzzUej+v6+rp2d3d/QBkaGtJEIgGIUxUKBR0ZGVER0c7OTs1kMp9mLMvSSCRiUDo6OjSbzQLiRBsbG+ZGHx4efjtn27ZOT0+b2aWlJUCcqLe319zkdDr94+zt7a2Z7evr46TuRJWVlVIqlcznVH6//9vZ9/d38Xq9IiLi8/kkn89zMPynq62tNevT09MfZ29ubsw6EAhwUnei4eFhs15YWJDHx8cv52zbluXlZfP36OgoJ3UnOjk5+fC2tqWlRff29jSRSGixWNSHhwc9Pj7WwcHBD3Nu+KLKteeQvz8W+d3HysoK5xAnK5VKOjc3px6P50cIr9er29vbfIX7p7q6upL9/X2xLEvu7+8ll8tJIBCQrq4uGRsbk5mZGWlubnbN9bge5P8Wv8sChAABhAABhAABhAABhAAhQAAhQAAhQAAhQAAhQAgQQAgQQAgQQAgQQAgQAgQQAgQQAgQQ+kP9BTRNDutKWRlFAAAAAElFTkSuQmCC"
        | _ -> "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH4gMTCSEXksk5IwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAgAElEQVR42u3deXQc1YEu8K+qelNLau22dttabGOMsbEBG2xsjDGrOSwDk5cEXkjIDCfJZIAskzDkJJkJ7w0BwhlCYLLn5CWBSUycZAIG401eMTZ4j421tNbWvvbeXXXv+0OyMWBZ3a1udUv6fuf45ET0UnX71lf33rp1S5FSShARTQIqi4CIGFhERAwsImJgERExsIiIGFhExMAiImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIiBRUTEwCIiYmAREQOLiIiBRUTEwCIiBhYREQOLiIiBRUQMLCIiBhYREQOLiBhYREQMLCIiBhYRMbCIiBhYREQMLCJiYBERMbCIiBhYRMTAIiJiYBERMbCIiIFFRMTAIiJiYBERA4uIiIFFRAwsIiIGFhERA4uIGFhERAwsIiIGFhExsIiIGFhERAwsImJgERExsIiIGFhExMAiImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiYmARETGwiIgYWETEwCIiYmARETGwiIiBRUTEwCIiYmAREQOLiCh1mFgENF5C6gjoLfDrbQjqLgRG/gWNboSMboSMHggRgIEgpAjCQBBCBCFkEEKGIGQIqmqBpqRBVdKgqWnQFDs0xQZNtUNT7LCaimA3lSPdUo10cxXslipYtXwW/jSjSCkli4HGYsgAhAzAEAH4wk70+nehz7cLPf4ahAwvFAVQzlYqBVAS0niXkFJCAjhbazOt1chLW4kSx/3Isi6EpmZAU9L4g41T0OhE48BPMC/vWwwsmgytpjC6vK+h0/M6+gL7YAgPdDGEsHBDSv1cOilQ8EFUJYOEhAQkoKlpsGgFSDOVo9hxH0ozPwWLlssfM4aT05b6IoSMAVTmPoaFBc8ysCh1+MJN8IWd8IROode3C73+XfCEXVABqAqgKJNtqFNCSAlDABmWIhRn3oeijHuQk3YVVMXKH3wMDf3P42T3owAAi1aAdXPqoanpDCxKnh7vdjQN/Qwdnj9ByDAw3NGayqMfUKCgzPEZLCh4FmbNwUowir+8r5w7SUkI3DC7FumWKgYWTZxO7+tod7+KweB7GAoegyEFVEzG1tM4215SQALIS1uBwoy7MSf7C9BU+5TZP3foFOr7nsHlM38MRYn+mtrxri+jof+HUM8LrKqcf8GCgv9gYFEixyH88IWdcPa/gMaBlyCBc5WQznUcYQhgVtanMC/v27CZy6Aptkm9T9uc8+ANn4FJycSa2UdhN8+JvM4IL7Y6KxAyej5USmmm2VhX0cDAokS0IHSc7nkCLe7fIKi3Q0Ik6Ird1AouBSqspiKUOz6H+fnfnZT74Q3XY4dzPiQEAAkFJqyZfRwZlnkRvd/l3ohD7fd+rL4YQuDO+akREwysKWIwcBjOgR+hafDnAFtTMRNSQFU0VOc+jlLH/ciwVE+abXcO/Agnur58/uENq6kQa2efhEnNGvP9r9c6YEgPPnrV15ACN1bUI91cwcCi8QkaXTjQeisGgu+yJZWAlleebTWWFv0ONnNxym/v1oYK+PWmj+2FWc3G+sr2i14hbRn6FQ63P3jBMU0hBZaX/BUzM25L+j6yhk9SntD7eLv1VrxRN5NhlaizOVT0BmqwpaEEe5pXonXotylcH85gKOS84F6ExQDO9H7vou9vHPjJqBdgFABh0Z8S+8laPsmExSBO9TyBbc756Pa9CVVRGVYJDi1FUdEf2I932z+NzXW5cLk3QshgSm1nQ/9zMCmj78Wpnu/BF2684H8N6O3o9e2/6Ocb0s/Aoui83/tdvFVfgtq+JzlGlYyDRVGhi0Ecar8XbzWUocv7Rkpsl5Bh9Ph2XHSKiklVcMj1dyMD8h/2rusTUNWLpjYMwcCiCA0Gj6CmaQlO93wHhvSzRZUCra6Q0Yt9rbfgYNtdcAdPJXV7dOGBT3eOudVDoRMI6d0f+mtQ70B/cP+YdUrIAAOLxuYceAk1jUswFDzGVlWK0RQVHd6/YFvjAhzr/CKEDCVlO1zuVyDE2N8tRBBt7lc+cjI8BimNsfdVzWBg0egCegd2N1+NY51fmHaz0SdjcDUOvIitDbNR1//MxA8V9HwHihLBDegK0OH5y4f+FFG3VgJmNZuBRaOdMf+IN+uLMBA4xFbVZOkmKiqCRidOdn0N2xqqMRh4b0K+1xN6HwGjC5GsmKFARa9/54f+1un9ayR5BZspNaZ18GhIMXuaV+Ld9nsZVJOUqqjw6Q3Y1XwVDrX9XcK/r9v3FtQoVvcxpEDI6BsOImlgMFg7dldSAtm2KxhY9AFvyImtDXPQ59/LwpgSJFyeV7HdORc9vpqEfUuPb2dUh7ECwB06OdId3BxB2Ank26+GSU2N1S0YWCnAHTyJbc4K+PVmjldNsW6iN1yPPS1rcLzrnyGliPt39EYZhooCeEauavb4asYMAAlgceGvUqcFy2qVXM6Bl7Cz6XIG1RSmKSqc/c9jm7MKA4FDcftcf9gFv94TXWBBhSd8GgAwEDw0Zr1LM5Uh3VzJwCLgZPfXcKTjC5jaC+fR2daWX29GTdOVaBz4r4imEozZuvLvhBLD6tSeUC0AiZDRedHXGULgkrwnoSpmBtb0Ht0wUNO0BA39z8Kk8ieYTr+8qqg43vUF1DQtHndo6WIopvf5wnWQUiD4kUmkH+WwXoLSrPtTqgR5tCTBvpZ1GAweQXIf3kBJbG9hKHQCr9XZ0e7eNI7AGoypBnlCdZAwPrJQ38fNzfvXlCs5BtYEEjKImsbF6PPX8PaaaR9ZKqTUccB1N052fyWm1lasg/iG0NHm/v2Y25cKy8kwsJJod/NyDIaOsmVF52iKivr+H2BX87Kou3g2U3FMo5+qCrzf861RZ8dLKVCe9fmUmd3OwJrokQupY1/LWgwFj7JlRRdszQwFj2FrwxwMBN6NPLDMJTFdr1Ggjiz0d+HAEgCqcx9PybLi0ZPwbqCO7Y0LRm6JYMuKRhcWA9jTvBzOgRcier01xhbW2dgaNQi1XKSZSxlY09E7bRvgC9cyrCiy1jgEjnT8Ew667sZYzac0rSQh22BL0bBiYCXYkY7PjdwNz2KmyJlUFR2eTXitNh2+8OjrXJm1rIScBs1q6j5klkdSgjQO/BjNQ7/gDHaK+dAUMogdjQvg7B+9i2gz5cb9mzU1k4E1nfT4tuNIx8McYKdxEzKEY13/hJPdX73gAoEWLT/+LTwlI2XLg0dUnOliCPtb10HjDHaK10GqqGjofw47GhdCfGS+Vli44/xtEuYInmHIwJr0JAzpx3bnJSwKSghvuBZv1GWj0/P6cI2TOvx6e5xrsYRZy07ZMjCxGsSLguNdX0bAcLErSAmqYSoM6cPe1tuwaMb3oQt3QgbdU3kMi4EVJy2Dv0LTwM+4UiglnFlVcarnG1Bgin99kxzDmvIM4cPJ7q8yrGiCByH0BHwmYNJ4lXBKq2lahpDoZUHQlMAW1hTWNPgzeMOnOG5FU6TVhpQedOdRNg5ChnGk4/MsRppSiWXR8hhYU9GBtg0xLVFLlNotrPyU3T4GVox84Ub0+newK0hTLrAsKgNryjnYdhekDLMgaEqxqCaYNd78PKW0uzdhgGuy05RrXQksKHg6pbeRgRWD071PcM4VTTmaYkeJ438xsKZUWHU/gaHg31gQNLVaV1KgKOMuWLWZKb2dipSST/GMkF9vw9aGchYETckOoc1UgjLHZ1Ge9SDs5tkMrMnuXdcn4PL8gQVBU5qQAoUZd2DxzP+C1VSIVBqrZWBFqN29CQfa7uY6VzRN2lsCClTk29fi8hk/hd2SGi0uBlYEDBnAtoYKBI1OFgZNu+gKGRJXFL6AOTlfTPrWsLkQgYOuexAw2lkQNA0psGgqjnd9Cad7vsPASnUu90Z0el7njHaa3rGlqDjT+1243Mkdw2WXcAyv1zlgCC8LgghA2BC4oeI9ZFmXsIWVWj13AzVNS6DHfZF/osnLrKnY17IGYWOQgZVKzvQ+icHgEXYFiT5CF25sa6yAIQIMrFTQPPhLnO75NsOK6IIUhI0BHO64n4GVbIFwG453fYn3ChKNoXVoI97v/e7ERiUH3T8QMnqxpb4QEoKFQRRRW0vFyvL9yLYtYwtrou1qWsawIoqChMCelmsRNLoZWBNFSB07GhfCpzeyMIiiDS2p4+3W9QysibKvZRU8ob9xkD2xpwUWwRQ2GDiCE12PJr4LOt3HsPa33oRu7xYoHGRPCF0IFGduQFXu1+AOnkS/fx96/XswFHRCVQBVAct+yvRUBFaW1SDPfh0DK/6FG0RN4xK4+UzBhKrK+QYuKXjyAt0IiXbPRrjcv0d/4AB04YEh3BDQoUABl5+enKzaTKyvdDGw4m2bcx584VoeGAl0Tel25NlXj/k6CYGw0Y+w0Yd+/wG0e/6Idu+fYAg50gpjgE0WUgqUOD6BpUUvM7DiIWh0YnfTCvh0J1tWiamysGozsax4E3LTlo/rk7yhevT6d6LPvx++cAP8ehO8oQaIkfhSFPA3TEGaYse6iiZYtFwG1ngMBY9jR+OiBE4KVc4dtNM1rMxqAW6oOAOzmpWwbxkMHEG7dxM63H/GUOgoQyvlaoHApfnfR2Xu1xhYsXIOvIiT3Y8l7FmCmZYFMGnZ6Pfvi/tnCymgACjPfgilmZ9Ejm053KETONH1CHr9+1JiVr6QAsUZ92BZ8X9DUbQJ/W5/uBXbG6shZIhpkUKhdXt1EKpiievnqtOh6M70fg/HO7+YkLCSELBoBSjP+hx6vHvi+rmKYka6uRILZzyHO+ZJLJ75U+Tbr4empiHbdiVWlu/FwhnPQVMzkjzhVaIi58u4smTjhIcVABzv/lJSbsQ9f/854fhjRQLnwA/ZworWnuZr0RfYl6Bug0SG5VKsKj+ArQ2lCIvBOHyigJBAZfYXUJ33r7BqM8cMAV14cLL7UTQO/GzCW1u6EFhRugmFGXcm5fft8+/H3pZVSeuGCymQm3Y18myrUDfwLKSUvA91RLbtaqwqj2+PY8oGVq9vFw667kTI6E/IPB8JgZnpG3BV8Z+wu2U5BvwHx/U9QgqkmYpRlvUgKnMehUXLi/ozurxbcLL7MQwFTyb8oJEQMKtZWF7yJnLSrk7Kb2xIP96smwFD+ib+u4VAnn05qnMfR2HGhnN/d7lfRZv7d+j2vomQ8EJL+BVOCXGBQ3j4okRyg1NIgVuq+mDRchhYF/O37m+gtu+phB20EgKlmZ/GFUX/D2d6/w/e7/3WeH9azMl+FAtn/CAu21ff9wz+1vONhLY6rNpMrKtohqqYkvY7v9N2Bzq9f8VET3nQlHQsL30TuWkrLvq65sFf4WT3I9CFJ2G/hc1UijLHA9DFIAAVqpoGDXYE9Ga0uf97JMyTc4hLKVDueBCLi37BwLqQgN6Og6670O8/kLCziy4Elhb9AuVZD8Ll/gMOuu6LORglBKxaIZaXbEaWbXFct9Mbqsfhzs+gz7cnrmUhIZBursSq8rdh0fKT9lt3et7AgbZbJqwVYUiBDMscXFrwLIoy7oqivAx0eP4Hf+v+OtyhWmhx3t5081ysnXNq9J6Gfzfqep+Cy/MaTEl4RJ0CDesrO+I2xWHKBFavbxf2t61P2FVACQGLmovlZW8h23oFgnoHtjXOjXm9dwmBTMuluH72iYSWy4muR9A4+NJIuSjjLoMMczVWzzoOTbUgWZM5Q0YvNtflT8BY0XB3y24uQWXO11GR8+Vxfdrpnm+jtu/JuLZ4NDUDt1aNPXba7z+A9zruhzdcO+HTQJYWvYzizPsYWGftb12PHt+2hDZtizLvwhWFv4Om2gAAW+qLETQ6YjpopRTIta/CtaU7JuSqmi/kxM6my0a6B7GHTJZ1CVaVH0jKlcDzHXLdi3bPHxPenTFrObiq+E/ISVset8vzXd4tONB2a9xCSxcCd82XEe6TgR7fdrzTtgECoQk74Vi1GVhfGZ/H5E3qyxnt7lexuS4H3d63EtaqMqlZWFz4c1xZ/EdoqhUAcLjjwZHnFEb/gxtCoMzxAFaW7ZqwA99umYP1lR2wajNjb11qBVhRui3pA7nNg79Ey9DGhLWoDCGQbVuKJUW/xi1VfcizXxfXuUQz0tejIucRGDJ+0yCCek9krRNFQ0H6jbi5ahCVOV+HAm1CpmME9A4caL1t+rawJAwcaL0dXb43Etq8dVgXY1X5/g9V2Lahl3HQ9ckYH1kvUZ37OObnfy8p5dYfOIidjVdFPZahKWlYX9kBk5qR1N89aHRhu7N6ZBA7/qMtZ1tUuWnXJnxf9rZchz7/3nF/jiEEVpXvQp59VQzvDWBvy0oMBo8g0QPzUgqUOoYvVE2rFlZD/3/izbqZ6PImJqwkBBRoWFb0e6ye9e6HwsodPI33Ou6PKawMKVDmeDBpYQUAObYrkZe2NOryKHU8kPSwAoB32jYgLIbi+pmGEMi1XYNrympwc2X3hIQVAFxR+FsYIg6tGwVwh07G9FZNteG6WYewvGQzzGpuQltbiqKiZeg3ONb58PQIrKHgUWx3zsfxrkcQFvGfWyUhoCo2lGZ+CrdV+1GUec/HXrO/dV1MZyIJgZKMu7C48OdJL8eKnMeiPDMCdvOspG93Xd/T6PO/E5eTlJQCqmIZuVtgO64t3428CQqqs9LMZVg08z8hx9k1VAC4gyfH9RnD3cRulGY+kNBuoqqoaOj/MY52fH5qdwn3t96EXt8OSOhIxEChkAIlmfdgceEvYFIdF3zNe+33o9X9m6gPGAmBLOsyrJ51MCXKMqB34K2GMkS+AqhEccZ9WFr8StK2WRdevFGXBTnubouEISSqch/B3LwnYNZyknrjtJQ6djReCm+4blwn2vy063FN2fb4dLv1buxrXQt36EQCy0aiKOMeLCuO/rH3KdvCEjKM2t7/wF/PmNHt3QIJI85hJaELgTz79VhVvhvLijeOGlYhoxcu9ysxhZXDsjBlwgoAbKZCOKyXRXEWVeAJv5+0e+Wk1FHTdDkEjNi7fVLAouVhbt53cfvcQSyc8RwsWl7SV3lQFBMWzXgJ+ji6hgpUeMNn4rZNVlMBrp99HItmvAST6hh3C3C0rW5zb8Q7bXdO/sAanmj3Z2yuc+B07+MjNwGrcf0GBSpsplKsnrUb15RuRW7ayou+YzB4BIbUo/4mk5qFNbOPp9zJoDrvCYgoGitDwaMQSbq5uKH/BfjCsa9dZlIduKzgGdxU2YV5ed8a9aSULPnpazE7+3+P6zMM4YeMoX5ezOzsh3FLVT9KMj8BBRriPSivKio6PH/GnuaVkzewnP0/wraGShxou3NkqZD4tqjChkCB/WasLN+LGyuaxgyqD5rJ7TF8m8CKkjdTsvVanHE3TFFcqhdSoq7v6QnfzsHAezjRHf2DDYQUMKvZWFb0B9xY0YzK3K+k9JDH8IUYZRw124AuvQnZtqXFL2PN7BPITbsurlMxhluYKvoCe7G3OfIrnEkPLAmBLu9mbG2owNGuL8Gvt8R1BvPwAKsZ+fZ1uLHiBJaXvo5s21VRVZCw0R/1AVOV/dWk3RQciWzblVGdDYdnaE9sV/Ad111R1YWz8+aqcr+Gm6t6UZR5N0xqJlJdmqkUlTlfgYgxEKTUYSRkqsewDMtcXFu2E8uKfg2bqSTm7RytS9vr34OaxsXQhTu1A6vPtwdv1BXgQNsG+PWmON9nJSGkwKysf8DNlf1YUboFmdZLYzwTmKNr5ttXY8GMp1P6IMmzr4pqXEpCh2vo9xO2fSe7vw6/3hzViSnXtgI3VjTj0oLvY7JZUPAUCtKvj+m9QoYQNgYSvo2ljvtxY0UTFhQ8FdexLUVRMRQ6ji31JQgZXakXWK1Dv8We5mtQ07wKuhiIW/9YQsAQAg7r5Vg444e4paoHlxf+GJqaNs6zQOQz0g0hcEkS51pFqijjHkQ31qvgTN+/T8i2dXo3o67vuYjHrc4++GBl+b6UmC8Wc/er8JWReX8yynqvIzjGgR7Hjhyqc7+OG+acwaysf4SUIm7hZUgvtjnnose3I/mBpQsPmgZ/jtdq7Xiv/dPoDxyI093jEoACk5qJAvuNWDvnKFbPeg9zsr8Y05pSF+4SmSPelmzboojHxpLbJVwGqym6dYr6AyfQ7k7sPXxBvQsHXXdGMTlXItt2ZcKe0jKRrKYZuH72KaiKNer3DgQOTei2pluqsWjmi9gwT6Ak8++hKra4NDx04cbelrVwuV9NTmAF9A4cdN2Nrc7ZONrxEIQMjvuqn5ACYSGQZirH/LwnsXrWYayb04AVpVvgsC5KwEnFFOGhIyN6rFWqWDTzxajOjiZVxcnuxyBkMDF1JezC9sZ5Uay4ocCiFeDasp2YKuzm2Vhe8gbCRjStFgVt7uQEtgIFS4tfGe4q5j8dl4F5VVHxbvu9ONh293mNkgQHVp9/L95x3YnX64rQ7tmEcIwrfw4vGTzc7LSbZiPfvg4LC57FbVUdWFfhRHXeN+GwXgZzAh4pdO5AVWyYimbYb4q6C+XXW9Dvj/+8Mm+oATubLhtZiE6JsG4YuLpkMzTVPqV+lzz7alxd8tuoBrf7/IfR69+dtG22aPmozP0K1s05jWzrlXGYt6eg3bNpZNrDB/Uh7stFtg79Dsc6/xGG9GP4sU+x3SR8dlbzDPvNKM96CIXpG6Ao2kjoTew6TKYIu5YKAE/o/UlzYJi1HFTmPIbTvf8W1dW4A20349bq+F2VCujtqGlaNFJnIv9tlxT+Gtm2K6bkyaTE8UkEjW4c73okot/GpKo43P4A1lU0IJkPnc2wzMOqWW/jVM8TeL/3yXFfSCtzfHiOWlxuzfGHm9Ew8Dzahl6GL+yK6ubgsw9dkBLIti1Aftoa5KStgMO6GA7rwpSoPJE/z1DCrObj5qquSXVw7G1Zg74ozs5SClTnPY5L8sc/1aHD8xccdN0NnHs8amS1Js00C+sqnJjqjnf9Mxr6n48otIQUKEy/DVeX/jUltr3D8z94p+0OKDGua29Ws7CuogUmNX38gSWlAb/eglM930TL0CsRLLYvR1pOgAozNDUdmpqObOtSlDo+jeLMe1O20gT0DrxZXxRRpdGFwG3VPXEb8J8IYTGAtxrKRlZPjaxiaUoabq7qjWmA+Hwu90Yc7XwIuhiK+LuFFFg75xQyLfMxHbzjugudnj9HWD4SC/KfRWXuoymx7SFjADsbF0S92OVoy9HEFFhtQ6/gTN+/wRuqg0B41MvPZ1tPQgAZliLMTL8dMzM2INN6CcxqTtJvPo2ULjx4rTYzosCSUmBJ0a9R5rh/Uh0UQb0D25zVET+BRkIgx7Ycq8r3j/u7u7xvYX/r+oi7pXbzHNwwpw7ThZBh7GxcCG+4NqKDXkqBxYXDzx1IleNnd/PV8IRORX5CHGXpZ1PkFboT7Z5NONP7HfjCnee6fQpUSAhIOdyGMqs22M2VsJvnIMt6OfLSrkOeffW4z8TJpECJ+GBSFBVd3s2TLrCspkJcUfQyDrXfE9F9aQpU9AfeRn3fD1CZ+9i4vjvLuiSqC+LJfWjqxFMVM1aUvoUtDbOgKkpEdfBY5z8gy3Y5sqzJH+MzqelYM+so9rWuRY9vd0TH0qIZL15438ZqYenCiyMdn4HLs/ECraHht2ZaFqI4814UZ9yHDOs8nJ0bNVUYwoc36vOieBS6gg1z9Um5r+7QKexqWgIR4dQCKQUqch7BwhnPjaMFEcRrtemIdB6PIQRuqe6GNYlP7UmGIx0PoWXol5GXqxC4qcoFm6koZfbhWOfDaBr8yUXyQcKkZuOWqr5IA2s4bFzuP8A58AK6vLtgSCDDnINM6+VwWC+Dw3IZ7OZZsJnLkG6uimJi5SQNLOnHlvqiiO51OjvGMi/vCczP//dJub/OgRdxtOOLEV88kRAod3w25gUKhQxjS30hwiKy20ukFJid/TAWzXxpWgXWYOAwapquiGp6kFUrxJrZx1JqTLXN/Xsc7fgswsL7sdaWAhNumFOLNHN55C2so50PI2z0Icu2BLlpq5A3CWZuJ3YMIYAtDeUIG71RdCPNuH1udJfpU8nwU4E6I3798JOwb8eVxa9G/dAGKXVsc1ZHde+gAhW3zw1hKrXkI7GjcRHcoePRjf1K4IaKhpRYOfZ8hzseRJf3dYSMnnPDSvPzv415ed8Z/Xefqo+qj29gBbHVWRnVMjMKVKwqfxtZtqWTcp/r+p7CqZ5vRhUIEgJ2cwVWz3oXZjU7ivcZ2NW0FEPBaNYOU7CqfN/IyhvThy/cjLcaZkW9oomimHFd+QE4rJen1P7owg1/uAVd3tchYaAq918u+noVFFn8RNtqgECbe+Ok3ePizE/AiPJcpkCFP+zE5toc1Pb934jH/BSoMSysJ9E69NtpVxPt5lJkx/CUcCl17GpadtEbi5PBpGYi07oAlblfHTOsGFgRH4gKVET/bLr6/mcm8YExCw7L2QsoUZaWouJ0zxN4rTYN/f4DEb3HpObEUL7PT8PaqCLbdlUMt75ISIiRG4v/MIn3niIqplgepqkLHV3eLZN2ry8teAZinCMGu5uX42Db3TDGuGE60zI3pmVK6vuenXa1sTDjjqiWuP5QTVZUvNv+96jte4qBNXWbWApUNfoboDUVaB786aTd7fz0tTBrjnEWnYoO75/w2hkburxvjPq6DMslUbflVEVF0+BPIKUxrarjTPttGN95RMGpnm/A2f8jBtbU7BKqUGGCkCKqf1IC/YG3o5i/lWKVQ7HBbiqPer8//m/4lqz9rbeM+qSUDMt86AJRf7Y7dAZBvXO6VUhk2xaM6zeREjja9SUcbn8QiX7qc1x3nVcJIzMUPBb12u4j7Szk2ldEtWppKnEHTyJo9MRt8oCQOrJtV8Cs5QGU5KwAAAGxSURBVHzk70H0+fZAUaJbQERCIsNSDZupZFrVx8HAYfjCjefdWDz8T4ECKB/5/+f9L8777woUSGkg374m6nJnYBERsUtIRAwsIiIGFhERA4uIGFhERAwsIiIGFhExsIiIGFhERAwsImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIgYWETEwCIiYmARETGwiIiBRUTEwCIiYmAREQOLiIiBRUQMLCIiBhYREQOLiBhYREQMLCIiBhYRMbCIiBhYREQMLCJiYBERMbCIiBhYRMTAIiJiYBERMbCIiIFFRMTAIiJiYBERA4uIiIFFRMTAIiIGFhERA4uIiIFFRAwsIiIGFhERA4uIGFhERAwsImJgERExsIiIGFhExMAiImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIgYWETEwCIiirv/D5iHafdRpSURAAAAAElFTkSuQmCC"

    let cell x y = 
        alist {
            let! card = aget m.board (x,y)
            if card.flipped 
            then 
                let image = selectedCard card.value
                yield img [
                    attribute "src" image
                    attribute "alt" "Flipped Card"
                    attribute "width" "100 px"
                    attribute "height" "100 px"
                    ]
            else 
                yield input [
                    attribute "type" "image"
                    attribute "src" "data:image/png;base64,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0zI3pmVK6vuenXa1sTDjjqiWuP5QTVZUvNv+96jte4qBNXWbWApUNfoboDUVaB786aTd7fz0tTBrjnEWnYoO75/w2hkburxvjPq6DMslUbflVEVF0+BPIKUxrarjTPttGN95RMGpnm/A2f8jBtbU7BKqUGGCkCKqf1IC/YG3o5i/lWKVQ7HBbiqPer8//m/4lqz9rbeM+qSUDMt86AJRf7Y7dAZBvXO6VUhk2xaM6zeREjja9SUcbn8QiX7qc1x3nVcJIzMUPBb12u4j7Szk2ldEtWppKnEHTyJo9MRt8oCQOrJtV8Cs5QGU5KwAAAGxSURBVHzk70H0+fZAUaJbQERCIsNSDZupZFrVx8HAYfjCjefdWDz8T4ECKB/5/+f9L8777woUSGkg374m6nJnYBERsUtIRAwsIiIGFhERA4uIGFhERAwsIiIGFhExsIiIGFhERAwsImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIgYWETEwCIiYmARETGwiIiBRUTEwCIiYmAREQOLiIiBRUQMLCIiBhYREQOLiBhYREQMLCIiBhYRMbCIiBhYREQMLCJiYBERMbCIiBhYRMTAIiJiYBERMbCIiIFFRMTAIiJiYBERA4uIiIFFRMTAIiIGFhERA4uIiIFFRAwsIiIGFhERA4uIGFhERAwsImJgERExsIiIGFhExMAiImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIgYWETEwCIiirv/D5iHafdRpSURAAAAAElFTkSuQmCC"
                    attribute "width" "100 px"
                    attribute "height" "100 px"
                    onClick (fun _ -> (Flip (x,y)))
                ]
                
//                yield img [
//                    attribute "src" "data:image/png;base64,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0zI3pmVK6vuenXa1sTDjjqiWuP5QTVZUvNv+96jte4qBNXWbWApUNfoboDUVaB786aTd7fz0tTBrjnEWnYoO75/w2hkburxvjPq6DMslUbflVEVF0+BPIKUxrarjTPttGN95RMGpnm/A2f8jBtbU7BKqUGGCkCKqf1IC/YG3o5i/lWKVQ7HBbiqPer8//m/4lqz9rbeM+qSUDMt86AJRf7Y7dAZBvXO6VUhk2xaM6zeREjja9SUcbn8QiX7qc1x3nVcJIzMUPBb12u4j7Szk2ldEtWppKnEHTyJo9MRt8oCQOrJtV8Cs5QGU5KwAAAGxSURBVHzk70H0+fZAUaJbQERCIsNSDZupZFrVx8HAYfjCjefdWDz8T4ECKB/5/+f9L8777woUSGkg374m6nJnYBERsUtIRAwsIiIGFhERA4uIGFhERAwsIiIGFhExsIiIGFhERAwsImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIgYWETEwCIiYmARETGwiIiBRUTEwCIiYmAREQOLiIiBRUQMLCIiBhYREQOLiBhYREQMLCIiBhYRMbCIiBhYREQMLCJiYBERMbCIiBhYRMTAIiJiYBERMbCIiIFFRMTAIiJiYBERA4uIiIFFRMTAIiIGFhERA4uIiIFFRAwsIiIGFhERA4uIGFhERAwsImJgERExsIiIGFhExMAiImJgERExsIiIgUVExMAiImJgEREDi4iIgUVExMAiIgYWEREDi4iIgUVEDCwiIgYWEREDi4gYWEREDCwiIgYWETGwiIgYWEREDCwiYmARETGwiIgYWETEwCIiirv/D5iHafdRpSURAAAAAElFTkSuQmCC"
//                    attribute "alt" "Card Back-Side"
//                    attribute "width" "100 px"
//                    attribute "height" "100 px"
//                    //attribute "onClick" "flip(event)"
//                    onEvent "onClick" ["{ name : event.dataTransfer.getData('source')}"] (fun args -> printfn "dragged thing: %A" args; (Flip (x,y)) )
//                ]
        }

    let rowview  y=
        alist {
            for x in [0..(size-1)] do
                yield Incremental.td (AttributeMap.ofList [style "border-collapse:collapse; border: solid medium"]) (cell x y)
        }


    let tableview = 
        alist {
            for y in [0..(size-1)] do
                yield Incremental.tr AttributeMap.empty (rowview y)
        }

    let dependencies = 
        [ 
            //{ kind = Script; name = "memory"; url = "memory.js" }
        ]    

    require dependencies (
        body [][
            div [][
                h1 [][text "Memory"]
                text "Number moves: "
                Incremental.text ( m.moves |> Mod.map string ) 
                br []

                Incremental.text (m.infoText |> Mod.map string)

                Incremental.table (AttributeMap.ofList [style "border-collapse:collapse; border: solid medium"]) tableview

                button [onClick( fun _ -> Reset)][text "Restart"]
            ]
        ]
    )

let threads (model : Model) = 
    ThreadPool.empty

let app =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
    {
        unpersist = Unpersist.instance     
        threads = threads 
        initial = initialValues
        update = update 
        view = view
    }